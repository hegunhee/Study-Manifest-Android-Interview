## Q) 55. Jetpack Navigation 라이브러리란 무엇인가요?

* 앱 내 화면 간 이동을 **선언적**으로 정의해 보일러플레이트를 줄이고, **백 스택, 딥 링크, 전환 애니메이션** 등을 표준화해 주는 라이브러리.
* **Activity / Fragment / Composable** 대상의 내비게이션을 관리하며, **Safe Args**로 타입-세이프한 인수 전달을 지원.
* 핵심 구성 요소: **내비게이션 그래프**, **NavHostFragment**, **NavController**, **Safe Args**, **Deep Link**.

### 내비게이션 그래프 (Navigation Graph)

* XML로 **대상(화면)과 이동 경로**를 정의하는 중앙 관리 지점.
* 각 대상은 Fragment/Activity/커스텀 뷰를 나타내며, **액션/인수** 등을 선언적으로 설정.

```xml
<?xml version="1.0" encoding="utf-8"?>
<navigation xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto" <!-- app 네임스페이스 추가 -->
    xmlns:tools="http://schemas.android.com/tools" <!-- tools 네임스페이스 추가 (선택 사항) -->
    android:id="@+id/nav_graph"
    app:startDestination="@id/homeFragment">

    <fragment
        android:id="@+id/homeFragment"
        android:name="com.example.app.HomeFragment"
        android:label="Home"
        tools:layout="@layout/fragment_home"> <!-- 레이아웃 미리보기 (선택 사항) -->
        <action
            android:id="@+id/action_home_to_details"
            app:destination="@id/detailsFragment" />
    </fragment>

    <fragment
        android:id="@+id/detailsFragment"
        android:name="com.example.app.DetailsFragment"
        android:label="Details"
        tools:layout="@layout/fragment_details">
        <!-- 인수 정의 (예시) -->
        <argument
            android:name="itemId"
            app:argType="integer" />
    </fragment>
</navigation>
```

### NavHostFragment

* 그래프의 **컨테이너**로서 대상(Fragment 등)을 호스팅하고, 사용자의 이동에 따라 **동적으로 교체**.
* `app:defaultNavHost="true"` 설정 시 시스템 **뒤로 가기 버튼**과 통합.

```xml
<androidx.fragment.app.FragmentContainerView
    android:id="@+id/nav_host_fragment"
    android:name="androidx.navigation.fragment.NavHostFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    app:defaultNavHost="true" <!-- 뒤로 가기 버튼 처리 -->
    app:navGraph="@navigation/nav_graph" /> <!-- 내비게이션 그래프 참조 -->
```

### NavController

* **이동 실행 및 백 스택 제어**의 중심 객체.
* 코드에서 액션/목적지로 이동을 수행하고, 전체 **내비게이션 흐름을 제어**.

```kotlin
class MainActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        // NavHostFragment에서 NavController 찾기
        val navHostFragment = supportFragmentManager
            .findFragmentById(R.id.nav_host_fragment) as NavHostFragment
        val navController = navHostFragment.navController

        // 버튼 클릭 시 내비게이션 수행
        findViewById<Button>(R.id.navigateButton).setOnClickListener {
            // 액션 ID를 사용하여 이동
            navController.navigate(R.id.action_home_to_details)
        }
    }
}
```

### Safe Args

* Gradle 플러그인으로 **타입-세이프 인수 전달** 코드를 생성.
* 번들 수동 생성 없이 **컴파일 타임 안전성** 확보.

```kotlin
// HomeFragmentDirections 클래스는 Safe Args 플러그인이 생성
val action = HomeFragmentDirections.actionHomeToDetails(itemId = 42)
findNavController().navigate(action)
```

### Deep Linking

* URL/알림 등 외부 진입 지점을 통해 **특정 화면으로 직접 이동** 지원.
* 그래프에 **딥 링크 URI 패턴**을 선언.

```xml
<fragment
    android:id="@+id/detailsFragment"
    android:name="com.example.app.DetailsFragment">
    <deepLink
        app:uri="https://example.com/details/{itemId}" /> <!-- itemId 인수를 받는 딥 링크 -->
</fragment>
```

### Jetpack Navigation 라이브러리의 이점

1. 중앙 집중식 내비게이션: 명확하고 유지 관리 가능한 구조를 위해 모든 내비게이션 흐름을 하나의 XML 파일에서 관리합니다.
2. 타입-세이프 인수: 생성된 Safe Args 클래스를 사용하여 대상 간에 데이터를 안전하게 전달합니다.
3. 백 스택 관리: 일관된 내비게이션을 위해 백 스택 동작을 자동으로 처리합니다.
4. 딥 링크 지원: 외부 내비게이션 요청을 원활하게 처리하여 사용자 경험을 향상시킵니다.
5. Jetpack 컴포넌트와의 통합: Fragment, ViewModel, LiveData와 잘 작동하여 생명주기를 고려한 내비게이션을 보장합니다.

### 요약

* **선언적 그래프 + NavHost + NavController** 조합으로 화면 이동/백 스택/인수 전달을 표준화.
* **Safe Args**로 타입 안전성을 확보하고, **Deep Link**로 외부 진입을 매끄럽게 처리.
* 결과적으로 **보일러플레이트 감소**와 **일관된 내비게이션 패턴**으로 개발자·사용자 경험을 개선.

## ❓ Q) 35. ViewStub이란 무엇이고, 이를 사용하여 UI 성능을 최적화해 본 경험이 있나요?

---

### 📌 개념
- **ViewStub**은 안드로이드에서 **지연 로딩**(`lazy loading`)을 지원하는 **가벼운 뷰**(`View`)입니다.
- XML 레이아웃에 정의되지만, 실제로는 **UI 계층에 즉시 inflate되지 않고**, 필요할 때까지 메모리와 레이아웃 계산 리소스를 거의 사용하지 않습니다.
- 주로 초기 화면 렌더링 속도를 높이고, 사용자가 요청할 때만 무거운 레이아웃을 로드하는 데 사용됩니다.

---

### ⚙️ 동작 방식
1. XML에서 `<ViewStub>` 태그로 선언
2. 필요한 시점에 `inflate()` 또는 `setVisibility(View.VISIBLE)` 호출 시 레이아웃이 로드됨
3. 로드 후 ViewStub 자신은 뷰 계층에서 제거되고, 지정된 레이아웃 리소스로 대체됨

---

### 💡 사용 시 장점
- 초기 렌더링 시 불필요한 레이아웃을 미리 그리지 않아 **UI 응답성 향상**
- 메모리 사용량 절감
- 조건부 UI나 사용자 액션에 따라 표시되는 레이아웃에 적합

---

### 🛠️ 코드 예시

```xml
<!-- activity_main.xml -->
<ViewStub
    android:id="@+id/viewStub"
    android:layout="@layout/layout_heavy"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inflatedId="@+id/layoutHeavy"/>
```

```kotlin
// MainActivity.kt
val viewStub = findViewById<ViewStub>(R.id.viewStub)
viewStub.inflate() // 필요 시점에만 레이아웃 로드
```

---

### ⚠️ 주의사항
- 한 번 inflate된 ViewStub은 다시 사용할 수 없음 (다시 사용하려면 재생성 필요)
- ViewStub이 차지하는 자리는 초기엔 0px × 0px
- inflate 시점에 UI 스레드에서 실행되므로, 너무 큰 레이아웃이면 순간적인 렌더링 지연이 있을 수 있음

---

### 📈 실무 활용 경험 예시
- **대시보드 화면**에서 통계 그래프, 광고 배너 등 사용 빈도가 낮거나 네트워크 지연이 있는 UI를 ViewStub으로 구현
- 초기 화면은 핵심 UI만 표시 → 사용자 액션 발생 시 ViewStub inflate로 부하를 분산
- 이 방식으로 초기 렌더링 속도를 30~40% 향상시킨 사례 있음

---

## 💬 실전 질문 & 답변

**Q) ViewStub을 사용하여 UI 성능을 최적화한 경험이 있나요? 구체적으로 어떻게 적용했나요?**

**A)**  
네. 이전 프로젝트에서 **뉴스 앱 메인 화면**의 초기 로딩 속도를 개선하기 위해 ViewStub을 사용한 경험이 있습니다.  
해당 화면에는 **헤드라인 뉴스 영역**과 함께 **인기 기사, 추천 영상, 광고 배너** 등 다양한 UI 요소가 있었는데,  
광고 배너나 추천 영상은 사용자 스크롤 후에만 표시되므로 초기 로딩에 불필요했습니다.  

이를 해결하기 위해 다음과 같이 적용했습니다.

1. **광고 배너 레이아웃**과 **추천 영상 영역**을 `<ViewStub>`로 선언  
2. 화면 초기 로드 시에는 핵심 UI(헤드라인 뉴스)만 inflate  
3. 사용자가 스크롤하여 해당 영역이 화면에 진입할 때 `viewStub.inflate()` 호출  
4. 비동기로 데이터 로딩 → 레이아웃 inflate와 동시에 데이터 바인딩  

**성과:**  
- 초기 렌더링 속도 약 **35% 개선**
- 메모리 사용량 감소 (특히 저사양 기기에서 부드러운 스크롤 경험 확보)
- 필요할 때만 레이아웃 생성하여 **불필요한 CPU/GPU 연산 감소**

---

### 🏆 Pro Tips for Mastery
- ViewStub은 inflate 후 재사용이 불가능하므로, 같은 UI를 여러 번 표시해야 한다면 Fragment나 include 레이아웃을 고려
- 무거운 UI + 네트워크 호출이 필요한 경우, ViewStub과 비동기 로딩을 조합하면 초기 UX를 크게 향상시킬 수 있음
- `ViewStubProxy` 패턴을 사용하면 inflate 이후에도 뷰 참조를 안전하게 관리 가능

## ❓ Q25. 빌드 변형(Build Variants)과 플레이버(Product Flavors)

---

안드로이드 프로젝트에서는 하나의 코드베이스로 다양한 앱 버전을 효율적으로 빌드할 수 있도록, **빌드 변형(Build Variants)** 및 **제품 플레이버(Product Flavors)**라는 개념을 제공합니다. 이는 주로 기능 제한, 국가 구분, 배포 환경 구분 등에 활용됩니다.

---

### 🔹 빌드 타입 (Build Types)

빌드 타입은 앱을 어떻게 빌드할지를 정의합니다.

| 타입 | 설명 |
|------|------|
| **debug** | 개발용 빌드. 디버그 심볼 포함, 로그 가능, 최적화 미적용 |
| **release** | 배포용 빌드. 코드 최적화, 난독화, 서명 적용 |

필요에 따라 `staging`, `benchmark` 등 커스텀 타입도 추가 가능합니다.

---

### 🔹 제품 플레이버 (Product Flavors)

제품 플레이버는 앱의 기능/속성을 구분하기 위한 구성입니다.

예시:

- 무료 / 유료
- 국가별 (KR / US / EU)
- 브랜딩 (clientA / clientB)

플레이버마다 `applicationId`, `versionName`, 리소스, 코드 등을 개별 설정할 수 있습니다.

---

### 🔹 빌드 변형 (Build Variants)

빌드 타입과 제품 플레이버를 조합하면 다음과 같은 빌드 변형이 자동으로 생성됩니다.

예시:

- `freeDebug`
- `freeRelease`
- `paidDebug`
- `paidRelease`

각 빌드 변형은 개별적인 APK로 빌드될 수 있으며, 독립적인 동작 및 테스트가 가능합니다.

---

### 🧪 Gradle 예시

```kotlin
android {
    flavorDimensions += "version"

    productFlavors {
        create("free") {
            dimension = "version"
            applicationIdSuffix = ".free"
            versionNameSuffix = "-free"
        }

        create("paid") {
            dimension = "version"
            applicationIdSuffix = ".paid"
            versionNameSuffix = "-paid"
        }
    }
}
```

---

## 📁 Android Studio에서 버전별 코드 관리 방법

Android Studio는 `src/` 디렉터리 구조를 기반으로 빌드 변형별로 코드를 분리하여 관리할 수 있도록 지원합니다.

```
app/
└── src/
    ├── main/              ← 모든 빌드 공통 코드/리소스
    ├── debug/             ← debug 빌드 전용
    ├── release/           ← release 빌드 전용
    ├── free/              ← free flavor 전용
    ├── paid/              ← paid flavor 전용
    └── freeDebug/         ← free + debug 전용
```

- `src/main`: 기본 코드와 리소스를 포함
- `src/<플레이버>`, `src/<빌드타입>`: 변형 전용 코드/리소스 포함
- 빌드시 해당 디렉터리들이 병합되어 최종 APK에 포함됩니다

---

### 🔧 BuildConfig를 이용한 런타임 분기

```kotlin
// build.gradle
productFlavors {
    free {
        buildConfigField "boolean", "IS_PAID", "false"
    }
    paid {
        buildConfigField "boolean", "IS_PAID", "true"
    }
}

// Kotlin 코드
if (BuildConfig.IS_PAID) {
    // 유료 기능 로직
} else {
    // 무료 기능 로직
}
```

---

### 🎨 리소스 분기

이미지, 문자열, 색상 등 리소스도 아래처럼 분기할 수 있습니다.

```
src/
├── main/res/drawable/logo.png         ← 기본 리소스
├── free/res/drawable/logo.png         ← free 전용 리소스
└── paid/res/drawable/logo.png         ← paid 전용 리소스
```

빌드시 우선순위에 따라 적절한 리소스가 적용됩니다.

---

## 📌 정리

| 항목 | 설명 |
|------|------|
| **빌드 타입** | 앱의 상태(디버그/릴리즈)에 따라 동작을 구분 |
| **플레이버** | 앱의 종류(무료/유료, 국가별 등)를 구분 |
| **빌드 변형** | 위 둘을 조합한 실제 빌드 단위 |
| **코드/리소스 분리** | `src/<variant>` 구조로 파일을 분기 |
| **런타임 분기** | `BuildConfig` 또는 `resValue`로 조건 분기 가능 |

---

## 💬 실전 질문

### Q) 빌드 타입과 제품 플레이버의 차이점은 무엇이며, 빌드 변형을 생성하기 위해 그 두 가지가 어떤 식으로 함께 작동하나요?

**A)**  
빌드 타입은 주로 **개발 환경(debug)** 과 **배포 환경(release)** 을 구분하는 용도로 사용되며, 코드 난독화 여부, 로그 출력, 디버그 옵션 등에 영향을 미칩니다.

반면, 제품 플레이버는 **앱의 기능이나 대상에 따른 변형**을 정의하며, 예를 들어 무료/유료, 국가별, 테마별 버전 등을 분리하여 설정할 수 있습니다.

Android에서는 이 두 가지를 조합하여 **빌드 변형(Build Variant)** 을 구성합니다. 각 변형은 `src/` 디렉터리 구조 및 `build.gradle` 설정에 따라 서로 다른 코드와 리소스를 갖고 독립적으로 빌드됩니다. 따라서 하나의 프로젝트 내에서 효율적으로 다양한 앱 변형을 관리할 수 있습니다.

---

## ❓  Q31. 애플리케이션 용량을 줄이는 방법

### 1. 사용하지 않는 리소스 제거하기
- Gradle 옵션 `shrinkResources true`를 사용하면 코드 축소와 함께 미사용 리소스를 제거.
- Android Lint로 미사용 리소스를 식별 후 삭제.
- `resConfig`를 활용하여 필요한 언어만 포함해 불필요한 다국어 리소스를 제외.

### 2. R8 코드 축소 활성화하기
- R8은 코드 난독화, 축소, 최적화를 한 번에 수행.
- 불필요한 클래스·메서드·필드 제거.
- `proguard-rules.pro`로 필요한 요소만 보존.

### 3. 리소스 최적화 사용하기
- 벡터 드로어블(Vector Drawable)로 해상도별 중복 리소스 제거.
- 이미지 압축 도구(pngcrush, optipng) 활용.
- PNG/JPEG 대신 WebP 사용 → 용량 절감 + 시각 품질 유지.

### 4. Android App Bundle(AAB) 사용
- Google Play가 기기별 맞춤 APK를 생성·배포.
- 불필요한 해상도·언어·ABI 리소스 제외.

### 5. 네이티브 라이브러리 최적화
- `ndk.abiFilters`로 필요한 ABI만 포함 (예: armeabi-v7a, arm64-v8a).
- 불필요한 네이티브 코드 제거, 라이브러리 압축.

### 6. 디버그 정보 줄이기
- 릴리즈 빌드에서 `debuggable false`로 설정.
- 불필요한 로그와 StackTrace 제거.
- `minifyEnabled true`로 R8이 디버그 심볼 제거 가능.

### 7. 동적 기능 사용하기 (Dynamic Features)
- 자주 사용하지 않는 기능을 주문형 모듈(필요시 설치)로 분리
- 초기 다운로드 용량 줄이는데 도움이 됨

### 8. 앱 내 대용량 에셋 피하기
- 대용량 미디어(영상, 고음질 오디오 등)는 CDN에서 스트리밍.
- 설치 패키지 용량과 업데이트 크기를 최소화.

---

## 💡 실전 질문

**Q1) 앱에 APK/AAB 크기를 크게 증가시키는 고해상도 이미지가 포함되어 있습니다. 시각적 품질을 유지하면서 이미지 리소스를 어떻게 최적화하고, 최대 효율성을 위해 어떤 이미지 포맷을 사용할 수 있을까요?**

**답변:**  
- WebP 포맷을 사용하면 PNG/JPEG 대비 용량을 크게 줄이면서 품질을 유지할 수 있습니다.  
- 필요 시 손실(WebP lossy)·무손실(WebP lossless) 모드를 선택.  
- 벡터 드로어블을 적용해 해상도별 리소스를 하나의 파일로 대체.  
- 이미지 압축 도구(pngcrush, optipng, ImageOptim)를 활용해 불필요한 메타데이터와 색상 정보를 제거.  
- 해상도 스케일링(dpi bucket 최적화)로 기기에 맞는 최소 크기의 이미지 제공.  
- **부가 팁:** 이미지 용량이 크거나 업데이트 빈도가 높다면, 앱에 직접 포함하기보다 **CDN을 통한 외부 로드**로 용량과 업데이트 부담을 줄일 수 있습니다.

---

**Q2) 애플리케이션은 보통 여러 기능들이 포함되어 있지만 그중 일부는 사용자가 자주 사용하지 않습니다. 해당 기능을 필요할 때부터 사용할 수 있도록 하여 초기 앱 용량을 줄이는 방법에는 무엇이 있을까요?**

**답변:**  
- Google Play의 **동적 기능 모듈(Dynamic Feature)**을 사용합니다.  
- 초기 설치 시 필수 기능만 포함하고, 사용자가 해당 기능을 실행할 때 필요한 모듈을 다운로드하여 설치.  
- 예: 결제 모듈, 고급 분석 도구, 특정 지도 기능 등 자주 사용되지 않는 부가 기능.  
- 이 방식은 초기 다운로드 크기 감소와 업데이트 효율성을 동시에 확보할 수 있습니다.


---
### 📌 추가 내용 Play Feature Delivery vs Dynamic Feature

---

#### 1. Play Feature Delivery
- **정의**: Google Play가 앱의 특정 기능을 **언제, 어떤 조건에서, 어떻게** 설치할지 제어하는 배포 메커니즘.
- **설치 모드**:
  1. **Install-time** → 앱 설치 시 포함  
  2. **On-demand** → 필요할 때 다운로드  
  3. **Conditional** → 특정 조건(언어, 국가, 기기 등)일 때만 설치
- **목적**: 초기 설치 크기 감소 + 조건별 최적화

---

#### 2. Dynamic Feature (Dynamic Feature Module)
- **정의**: App Bundle 안에서 기능을 **모듈 단위로 분리**해, Play Feature Delivery를 통해 필요할 때만 설치할 수 있도록 만든 것
- **특징**:
  - Gradle에서 `com.android.dynamic-feature` 플러그인 사용
  - `SplitInstallManager` API로 런타임 다운로드 가능
  - On-demand / Conditional 모드 적용 가능
- **예시**: 여행 앱의 AR 지도 기능을 별도 모듈로 분리 → 사용자가 AR 버튼 클릭 시 다운로드

---

#### 3. 차이 요약

| 구분 | Play Feature Delivery | Dynamic Feature |
|------|----------------------|----------------|
| 개념 | 기능 설치 전략(언제·조건·방법) | 모듈 분리 구현 방식 |
| 범위 | 앱 전체 기능 설치 정책 | 특정 기능 |
| 관계 | 상위 개념 | 하위 구현 |

---

#### 4. Diagram

```plaintext
┌───────────────────────────┐
│    Play Feature Delivery  │   ← 기능 설치 전략 (Install-time / On-demand / Conditional)
│   ┌─────────────────────┐ │
│   │   Dynamic Feature   │ │   ← 기능을 모듈로 분리한 구현 단위
│   │  (login, map, etc.) │ │      * 필요한 시점에만 다운로드
│   └─────────────────────┘ │
└───────────────────────────┘
